%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%                                                                 %
%                            CHAPTER SEVEN                         %
%                                                                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 
\chapter{Conclusions and Future Works}

\section{Conclusions}
When solving PDE-constrained design optimization problems, many practitioners
favor a reduced-space formulation in which the state variables are implicit
functions of the design variables.  However, conventional reduced-space
algorithms are not well suited to problems with many state-based constraints,
because these algorithms require the contraint Jacobian explicilty, which
requires an adjoint for each row.

In this work we have developed a matrix-free algorithm to handle reduced-space
PDE-constrained optimization with state-based constraints.  To cope with
possibly indefinite Hessians, we follow the zero curve of a homotopy map using a
predictor-corrector algorithm.  The tangent and Newton update linear systems are
solved using a Krylov iterative method.  To precondition the Krylov solver, we
proposed a low-rank, approximate singular-value decomposition of the Schur
complement of the KKT matrix with respect to the slacks and multipliers.  All
the components of the algorithm --- the predictor-corrector scheme, the Krylov
method, and the preconditioner --- require only matrix-vector products and,
thus, avoid the need to compute the constraint Jacobian or Lagrangian Hessian
explicitly.

The numerical experiments suggest that the matrix-free algorithm is effective.
In particular, the results indicate that the algorithm can avoid stationary
points that are not minimizers and that it scales well with the number of design
variables.  On a synthetic quadratic optimization problem the proposed algorithm
was shown to be competitive with a state-of-the-art (matrix-explicit) active-set
SQP algorithm.  Furthermore, when applied to a difficult structural optimization
problem the algorithm was able to satisfy the optimality and feasibility
criteria whereas the matrix-explicit SQP algorithm failed to converge. 

The proposed algorithm indirectly uses the homotopy term as a globalization method, 
thus is avoid of line-search or trust-region globalization techniques. 
It is straightforward and clean to implement. 

\section{Future Works}

\begin{enumerate}
\item SNOPT's user solver interface is cleaner, can we adapt Kona in that sense a little? 
During the numerical experiments with CUTEr and SNOPT, I realized that the interfaces 
of the two are prepared for each other, in the sense that the problem formulation from CUTEr 
are just in the form as required by SNOPT. As described in~\ref{sec:cuternm}, CUTEr separates 
the bound constraints on the design variables from other types of constraints, providing $\text{bl}$ 
and $\text{bu}$. For other types of constraints, CUTEr align them into a vector using $c(x)$, 
together with the bound $\text{cl}$ and $\text{cu}$. SNOPT's solver interface exactly follows this 
pattern, and the user only need to provide $\text{bl}$ and $\text{bu}$,  $\text{cl}$ and $\text{cu}$ 
after defining $c(x)$. In Kona, the only separation in constraints 
are equality and inequality. So if there are both a lower and an upper bound constraint for a certain 
variable, $\text{bl} \leq x_i \leq \text{bl}$, it has to be defined as two inequality constraints 
$x_i - \text{bl} \geq 0 $ and $\text{bu} - x_i \geq 0 $. 

\item Separating bound, linear, nonlinear constraints in Kona? While separating bound constraints 
from other types of constraints is out of conforming to convention, separating linear with nonlinear 
constraints is for improving the robustness of the preconditioners as proposed in this thesis. For the 
ASO problem, the linear constraints refers to the geometric constraints, whose Jacobians are cheap 
to evaluate. The current preconditioner is using the Lanczos SVD method to approximate the whole 
inequality block in~\ref{eq:svd}, and the explicit Jacobian matrix of those geometric constraints are 
wasted in being computed and only to be multiplied with an incoming vector. After separating the linear 
geometric constraints with nonlinear aerodynamic constraints, the SVD approximation will be only 
applied to the nonlinear part, this way improving the effectiveness of the preconditioner. 
One potential counter argument could be that since Kona is branded as the ``matrix-free '' preconditioner, 
wouldn't it be self-deprecating to use explicit Jacobians for the linear constraints? We could be a little 
utilitarian and say that ``matrix-free '' is only used when necessary, for those expensive nonlinear 
constraints dependent on state variables. 

\item The investigation on the non-convexity handling ability has just get started, a good start. 
The amount of regularization from the homotopy term is limited, so it can not handle a sharply 
nonconvex problem like $-1000x^2$.  Extra mechanism to detect negative curvatures is needed. 
The novel solver \cite{hicken:flecs2014} could be used instead of the current FGMRES as well. 

\item After implementing the suggestions on separating the bounds, and only approximating the 
nonlinear part of the constraints using Lanczos SVD method, the speed of the algorithm will be 
much faster for the ASO problem, with the CPU time at least down by half. Then it's a good time to 
tackle the transonic wing design problem based on RANS. 

\item I notice that the pyOptSparse packages from MDOLab also contains the IPopt method. It is also 
worthwhile to make some comparisons with IPopt on the CUTEr problems. Most likely Kona will 
still be slow compared with IPopt. 

\item This proposed Homotopy RSNK is just in 1.0 version as a constrained optimization algorithm 
in Kona, and more efforts are needed to make it faster and robust. Features like warm start, 
intelligent parameter setting modules could be implemented. This way the user wouldn't have to 
tune the parameters for some difficult problems by trial-and-error.  

\item Finally, it is unrealistic to provide universal preconditioners for PDE-constrained optimization 
problems, the same reason why there is no universal PDE solvers. We can at best provide some good 
preconditioner candidates for the types of problems that we are familiar with. 

\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
