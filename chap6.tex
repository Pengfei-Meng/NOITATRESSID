%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%                                                                 %
%                            CHAPTER SEVEN                         %
%                                                                 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
 
\chapter{CONCLUSIONS AND FUTURE WORKS}

\section{Conclusions}
When solving PDE-constrained design optimization problems, many practitioners
favor a reduced-space formulation in which the state variables are implicit
functions of the design variables.  However, conventional reduced-space
algorithms are not well suited to problems with many state-based constraints,
because these algorithms require the contraint Jacobian explicilty, which
requires an adjoint for each row.

In this work we have developed a matrix-free algorithm to handle reduced-space
PDE-constrained optimization with state-based constraints.  To cope with
possibly indefinite Hessians, we follow the zero curve of a homotopy map using a
predictor-corrector algorithm.  The tangent and Newton update linear systems are
solved using a Krylov iterative method.  To precondition the Krylov solver, we
proposed a low-rank, approximate singular-value decomposition of the Schur
complement of the KKT matrix with respect to the slacks and multipliers.  All
the components of the algorithm - the predictor-corrector scheme, the Krylov
method, and the preconditioner - require only matrix-vector products and,
thus, avoid the need to compute the constraint Jacobian or Lagrangian Hessian
explicitly.

The numerical experiments suggest that the matrix-free algorithm is effective.
In particular, the results indicate that the algorithm can avoid stationary
points that are not minimizers and that it scales well with the number of design
variables.  On a synthetic quadratic optimization problem the proposed algorithm
was shown to be competitive with a state-of-the-art (matrix-explicit) active-set
SQP algorithm.  Furthermore, when applied to a difficult structural optimization
problem the algorithm was able to satisfy the optimality and feasibility
criteria whereas the matrix-explicit SQP algorithm failed to converge. 

The proposed algorithm indirectly uses the homotopy term as a globalization method, 
thus is avoid of line-search or trust-region globalization techniques. 
It is straightforward and clean to implement. 

\section{Future Works}

\begin{enumerate}
\item  As described in~\ref{sec:cuternm}, CUTEr separates 
the bound constraints on the design variables from other types of constraints, providing $\text{bl}$ 
and $\text{bu}$. For other types of constraints, CUTEr align them into a vector using $c(x)$, 
together with the bound $\text{cl}$ and $\text{cu}$. SNOPT's solver interface exactly follows this 
pattern, and the user only need to provide $\text{bl}$ and $\text{bu}$,  $\text{cl}$ and $\text{cu}$ 
after defining $c(x)$. In contrast, in Kona, the bound constraints are not separated from other 
types of constraints; inequality constraints are defined on only one side.  
So if there are both a lower and an upper bound constraint for a certain 
variable, $\text{bl} \leq x_i \leq \text{bl}$, it has to be defined as two inequality constraints 
$x_i - \text{bl} \geq 0 $ and $\text{bu} - x_i \geq 0 $. Perhaps in the future the solver interface of Kona 
can be changed in a simpler way?  

\item Separating linear and nonlinear constraints in Kona? While separating bound 
from other types of constraints is out of conforming to convention, separating linear with nonlinear 
constraints is for improving the robustness of the preconditioners proposed in this thesis. 
The current preconditioner is using the Lanczos SVD method to approximate the whole 
inequality Jacobian block in~\ref{eq:svd}, irrespective of linear or nonlinear constraints. 
That is a wasteful practice for not making use of the linear constraint Jacobians fully, but computing it each time 
and only use its matrix-vector product. The Lanczos SVD preconditioner will be more effective in approximating only the nonlinear inequality constraint part. Take the ASO problem for example, 
the linear constraints are consist of the geometric constraints, whose Jacobians are cheap 
to evaluate and only depend on the design variables. The nonlinear aerodynamic constraints are the part that benefit the most from matrix-vector product approximations using second-order adjoints. 
One potential counter argument could be that since Kona is branded as the ``matrix-free '' preconditioner, 
wouldn't it be self-deprecating to use explicit Jacobians for the linear constraints? We could be a little 
utilitarian and say that ``matrix-free '' is only used when necessary, for those expensive nonlinear 
constraints dependent on state variables. 

\item The investigation on the non-convexity handling ability has just get started, a good start. 
The amount of regularization from the homotopy term is limited, so it can not handle a sharply 
nonconvex problem like $-1000x^2$.  Extra mechanism to detect negative curvatures is needed. 
Moreover, the novel solver \cite{hicken:flecs2014} could be used instead of the current FGMRES. 

\item After implementing the suggestions on separating the bounds, linear and nonlinear constraints, and  
only approximating the nonlinear part of the constraints using Lanczos SVD method, the preconditioner 
will be more effective and faster for the ASO problem. Then it's time to 
tackle the transonic wing design problem based on RANS. 

\item I notice that the pyOptSparse packages from MDOLab also contains the IPopt method. It is 
worthwhile to make some comparisons with IPopt on the CUTEr problems. 

\item The \textbf{HSx} problem family in CUTEr itself is a good collection of problems for optimization 
algorithms. It incorporates different types of difficulties like bad scale, ill-condition, infeasible solution, 
degenerate constraints, etc.  

\item This proposed globalized RSNK is just in 1.0 version as a constrained optimization algorithm 
in Kona, and more efforts are needed to make it faster and robust. Features like warm start, 
intelligent parameter setting modules could be implemented. This way the user wouldn't have to 
tune the parameters for some difficult problems by trial-and-error.  

\item Finally, it is unrealistic to provide universal preconditioners for PDE-constrained optimization 
problems, the same reason why there is no universal PDE solvers. We can at best provide some good 
preconditioner candidates for the types of problems that we are familiar with. 

\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
